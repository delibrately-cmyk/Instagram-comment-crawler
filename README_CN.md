# Instagram è¯„è®ºçˆ¬è™« (å•è´´ç‰ˆ)

è¿™æ˜¯ä¸€ä¸ªåŸºäº Playwright çš„ Python å·¥å…·ï¼Œç”¨äºæŠ“å– Instagram å•ä¸ªå…¬å¼€å¸–å­ä¸‹çš„è¯„è®ºå’Œå›å¤ã€‚å®ƒé€šè¿‡æ¥ç®¡ç™»å½•åçš„æµè§ˆå™¨ä¼šè¯æ¥è·å–æ•°æ®ï¼Œæ— éœ€ç”³è¯·å®˜æ–¹ APIã€‚

[English README](README.md) | [ä¸­æ–‡è¯´æ˜](README_CN.md)

## ğŸ›  åŠŸèƒ½ç‰¹æ€§

ä½¿ç”¨æœ¬å·¥å…·ï¼Œä½ å¯ä»¥ï¼š

- **é‡‡é›†è¯„è®º**ï¼šæŠ“å–æŒ‡å®šå…¬å¼€å¸–å­ä¸‹çš„æ‰€æœ‰è¯„è®ºåŠå›å¤ã€‚
- **è‡ªåŠ¨æŠ“åŒ…**ï¼šé€šè¿‡æµè§ˆå™¨äº¤äº’è‡ªåŠ¨æ•è·æ‰€éœ€çš„èº«ä»½éªŒè¯ Headerã€Cookie å’Œ API ç«¯ç‚¹ï¼Œæ— éœ€æ‰‹åŠ¨å¤åˆ¶ã€‚
- **æ–­ç‚¹ç»­ä¼ **ï¼šæ”¯æŒä»»åŠ¡ä¸­æ–­åä»ä¸Šæ¬¡çš„ä½ç½®ç»§ç»­çˆ¬å–ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚

> **âš ï¸ é‡è¦æç¤º**
>
> æœ¬çˆ¬è™«ä¾èµ–äº Instagram çš„ç½‘é¡µç«¯ç»“æ„ã€‚å¦‚æœ Instagram æ›´æ–°äº†åçˆ¬è§„åˆ™æˆ– API æ¥å£ï¼Œå·¥å…·å¯èƒ½ä¼šå¤±æ•ˆã€‚  
> å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·å…ˆé‡æ–°è¿è¡Œâ€œæŠ“åŒ…æ­¥éª¤â€æ›´æ–°å‡­è¯ï¼Œæˆ–æŸ¥çœ‹ä¸‹æ–¹çš„ç–‘éš¾è§£ç­”ã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

- **Python**: 3.10+ï¼ˆæ¨è 3.11 æˆ– 3.12ï¼‰
- **ç³»ç»Ÿç»ˆç«¯**: Windows PowerShellï¼ˆæœ¬æ–‡æ¡£æ¼”ç¤ºå‘½ä»¤åŸºäº Windowsï¼‰
- **è´¦å·**: ä¸€ä¸ªèƒ½å¤Ÿè®¿é—®ç›®æ ‡å¸–å­çš„æœ‰æ•ˆ Instagram è´¦å·

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1ï¼šè¿›å…¥é¡¹ç›®ç›®å½•

```powershell
cd .\ig-comment-crawler
```

é¢„æœŸç»“æœï¼šç›®å½•ä¸‹åº”åŒ…å« `ig_crawler.py`ã€`run_ig_crawler.py` å’Œ `config.example.json`ã€‚

### æ­¥éª¤ 2ï¼šåˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```powershell
python -m venv .venv
.\.venv\Scripts\activate
```

é¢„æœŸç»“æœï¼šç»ˆç«¯æç¤ºç¬¦å‰æ–¹æ˜¾ç¤º `(.venv)`ã€‚

### æ­¥éª¤ 3ï¼šå®‰è£…ä¾èµ–

```powershell
python -m pip install -r requirements.txt -r requirements-dev.txt
python -m playwright install chromium
```

é¢„æœŸç»“æœï¼šæ‰€æœ‰åŒ…å®‰è£…æˆåŠŸï¼Œæ— æŠ¥é”™ã€‚

### æ­¥éª¤ 4ï¼šåˆ›å»ºæœ¬åœ°é…ç½®æ–‡ä»¶

```powershell
copy config.example.json config.json
copy .env.example .env
```

é¢„æœŸç»“æœï¼šæ ¹ç›®å½•ä¸‹ç”Ÿæˆ `config.json` å’Œ `.env`ã€‚  
æ³¨æ„ï¼šè¿™ä¸¤ä¸ªæ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œè¯·å‹¿æäº¤åˆ° GitHubã€‚

### æ­¥éª¤ 5ï¼šæŠ“å–è®¤è¯ä¿¡æ¯ (Auth Capture)

```powershell
python ig_auth_setup.py --post-url "https://www.instagram.com/p/POST_SHORTCODE/"
```

æ“ä½œæŒ‡å—ï¼š

1. æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€åï¼Œç™»å½• Instagramã€‚
2. å¦‚æœé‡åˆ°äºŒæ¬¡éªŒè¯ï¼Œè¯·å®ŒæˆéªŒè¯ã€‚
3. å¦‚æœæç¤ºå¯†ç é”™è¯¯å¹¶è¦æ±‚äºŒæ¬¡éªŒè¯ï¼Œå…ˆå®ŒæˆéªŒè¯ï¼Œå†æŠŠé‚®ç®±ä¸­çš„ä¸€æ¬¡æ€§ç™»å½•é“¾æ¥å¤åˆ¶åˆ° Python æ‰“å¼€çš„ Playwright æµè§ˆå™¨ä¸­æ‰“å¼€ã€‚
4. ç™»å½•æˆåŠŸåï¼Œæµè§ˆå™¨ä¼šè·³è½¬åˆ°ç›®æ ‡å¸–å­ã€‚
5. å‘ä¸‹æ»šåŠ¨è¯„è®ºåŒºï¼Œç›´åˆ°è‡³å°‘åŠ è½½å‡ºä¸€é¡µæ–°çš„è¯„è®ºï¼ˆè¿™ä¼šè§¦å‘ç½‘ç»œè¯·æ±‚ï¼‰ã€‚
6. ç­‰å¾…å‡ ç§’é’Ÿã€‚
7. å›åˆ°ç»ˆç«¯ï¼ŒæŒ‰ `Ctrl+C` ç»“æŸæŠ“åŒ…ã€‚

é¢„æœŸç»“æœï¼š

- `config.json` è‡ªåŠ¨å¡«å……äº† Cookies å’Œ API ç«¯ç‚¹ã€‚
- `.env` æ›´æ–°äº†ç¯å¢ƒå˜é‡ã€‚
- æŠ“åŒ…æ—¥å¿—ä¿å­˜åœ¨ `crawler_data/raw_responses/`ã€‚

### æ­¥éª¤ 6ï¼šéªŒè¯é…ç½®

æ‰“å¼€ `config.json`ï¼Œç¡®ä¿ä»¥ä¸‹å­—æ®µä¸å†æ˜¯ `YOUR_...` å ä½ç¬¦ï¼š

- `instagram.authentication.cookies`
- `instagram.authentication.headers`
- `instagram.endpoints.comments`
- `instagram.endpoints.comment_replies`

### æ­¥éª¤ 7ï¼šè¿è¡Œçˆ¬è™«

```powershell
python run_ig_crawler.py --post-url "https://www.instagram.com/p/POST_SHORTCODE/"
```

é¢„æœŸç»“æœï¼šç»ˆç«¯æ˜¾ç¤ºè¿›åº¦ï¼Œæœ€ç»ˆ JSON ç»“æœä¿å­˜åœ¨ `crawler_data/ig_comments/`ã€‚

## âš™ï¸ é«˜çº§ç”¨æ³•

### è¿è¡Œæ—¶é€‰é¡¹

```powershell
# ä»…æŠ“å–å‰ 400 æ¡è¯„è®ºï¼ˆå«å›å¤ï¼‰ååœæ­¢
python run_ig_crawler.py --post-url "https://www.instagram.com/p/POST_SHORTCODE/" --max-comments 400

# å¼ºåˆ¶ä»ä¸Šæ¬¡ä¸­æ–­çš„åœ°æ–¹ç»§ç»­ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰
python run_ig_crawler.py --post-url "https://www.instagram.com/p/POST_SHORTCODE/" --resume

# å¼ºåˆ¶é‡æ–°å¼€å§‹ï¼ˆä¸ä½¿ç”¨æ–­ç‚¹ç»­ä¼ ï¼‰
python run_ig_crawler.py --post-url "https://www.instagram.com/p/POST_SHORTCODE/" --no-resume

# ä¸æŠ“å–æ¥¼ä¸­æ¥¼å›å¤ï¼ˆä»…æŠ“å–ä¸€çº§è¯„è®ºï¼‰
python run_ig_crawler.py --post-url "https://www.instagram.com/p/POST_SHORTCODE/" --no-replies
```

### è¿è¡Œæµ‹è¯•

```powershell
python -m pytest -q
```

## ğŸ“Š è¾“å‡ºç»“æ„

ç»“æœ JSON æ–‡ä»¶åŒ…å«ï¼š

- `post`: å¸–å­åŸºç¡€ä¿¡æ¯ï¼ˆURLã€IDã€è¯´æ˜æ–‡å­—ï¼‰
- `comments`: è¯„è®ºåˆ—è¡¨ï¼ˆåŒ…å«åµŒå¥—çš„ `replies`ï¼‰
- ç»Ÿè®¡ä¿¡æ¯ï¼šæ€»æ•°ã€æŠ“å–æ—¶é—´ã€é¡µæ•°

### è¾“å‡ºç¤ºä¾‹ (Output Structure)

```json
{
  "post": {
    "media_id": "3822619...",
    "url": "https://www.instagram.com/p/POST_SHORTCODE/",
    "shortcode": "POST_SHORTCODE"
  },
  "comment_count": 3927,
  "comments": [
    {
      "id": "1825540...",
      "text": "ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥",
      "created_at": "2026-02-01T02:26:48Z",
      "like_count": 130,
      "user": {
        "id": "46481...",
        "username": "example_user",
        "is_verified": true
      },
      "replies": []
    }
  ]
}
```

## ğŸ”§ å¸¸è§é—®é¢˜ (Troubleshooting)

- **403 / 429 é”™è¯¯ï¼ˆRate Limitï¼‰**ï¼šè¯·æ±‚è¿‡äºé¢‘ç¹ã€‚è¯·å°è¯•é™ä½ `config.json` ä¸­çš„ `requests_per_minute`ï¼Œæˆ–é‡æ–°è¿è¡Œæ­¥éª¤ 5 æ›´æ–° Cookieã€‚
- **ç¼ºå°‘è¯„è®º/å›å¤**ï¼šAPI ç«¯ç‚¹å¯èƒ½å·²å˜åŠ¨ã€‚è¯·é‡æ–°è¿è¡Œ `ig_auth_setup.py` é‡æ–°æŠ“åŒ…ã€‚
- **ModuleNotFoundError**ï¼šè¯·ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤ï¼Œå¹¶å·²æ¿€æ´»è™šæ‹Ÿç¯å¢ƒã€‚

## âš–ï¸ å…è´£å£°æ˜ä¸åˆè§„ä½¿ç”¨

- **ä»…ä¾›å­¦ä¹ **ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºæŠ€æœ¯ç ”ç©¶å’Œå­¦ä¹  Python çˆ¬è™«æŠ€æœ¯ã€‚
- **åˆæ³•ä½¿ç”¨**ï¼šè¯·ç¡®ä¿ä½ æœ‰æƒè®¿é—®æŠ“å–çš„æ•°æ®ï¼Œå¹¶éµå®ˆ Instagram çš„æœåŠ¡æ¡æ¬¾åŠå½“åœ°æ³•å¾‹æ³•è§„ã€‚
- **éšç§ä¿æŠ¤**ï¼šè¯·å‹¿åœ¨æ²¡æœ‰æ³•å¾‹ä¾æ®çš„æƒ…å†µä¸‹æ”¶é›†ç”¨æˆ·çš„ä¸ªäººæ•æ„Ÿæ•°æ®ã€‚
- **ç¦æ­¢æ»¥ç”¨**ï¼šè¯·å‹¿å°†æœ¬é¡¹ç›®ç”¨äºç»•è¿‡å¹³å°å®‰å…¨æªæ–½æˆ–è¿›è¡Œæ¶æ„æ”»å‡»ã€‚

## ğŸ“„ å¼€æºåè®®

MIT Licenseï¼Œè¯¦è§ `LICENSE` æ–‡ä»¶ã€‚
